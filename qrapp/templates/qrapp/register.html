{% extends 'qrapp/base.html' %}

{% block content %}
<div class="d-flex justify-content-center align-items-center vh-100 bg-light">
    <div class="card shadow p-4" style="max-width: 850px; width: 98%; border-radius: 10px; overflow-y: hidden;">
        <h2 class="text-center mb-4 text-primary">Student Registration</h2>
        <div class="overflow-scroll" style="max-height: 600px; overflow-y: auto;">
            <form id="registrationForm" method="post" enctype="multipart/form-data" class="needs-validation" novalidate>
                {% csrf_token %}

                <!-- Form row: First Name and Last Name -->
                <div class="row mb-3">
                    <div class="col-md-6 d-flex align-items-center">
                        <label class="form-label" style="width: 100px;">First Name</label>
                        <div class="flex-grow-1">{{ form.first_name }}</div>
                    </div>
                    <div class="col-md-6 d-flex align-items-center">
                        <label class="form-label" style="width: 100px;">Last Name</label>
                        <div class="flex-grow-1">{{ form.last_name }}</div>
                    </div>
                </div>

                <!-- Form row: Student ID and Username -->
                <div class="row mb-3">
                    <div class="col-md-6 d-flex align-items-center">
                        <label class="form-label" style="width: 100px;">Student ID</label>
                        <div class="flex-grow-1">{{ form.student_id }}</div>
                    </div>
                    <div class="col-md-6 d-flex align-items-center">
                        <label class="form-label" style="width: 100px;">Username</label>
                        <div class="flex-grow-1">{{ form.username }}</div>
                    </div>
                </div>

                <!-- Form row: Email and Course -->
                <div class="row mb-3">
                    <div class="col-md-6 d-flex align-items-center">
                        <label class="form-label" style="width: 100px;">Email</label>
                        <div class="flex-grow-1">{{ form.email }}</div>
                    </div>
                    <div class="col-md-6 d-flex align-items-center">
                        <label class="form-label" style="width: 100px;">Course</label>
                        <div class="flex-grow-1">{{ form.course }}</div>
                    </div>
                </div>

                <!-- Form row: Year and Major -->
                <div class="row mb-3">
                    <div class="col-md-6 d-flex align-items-center">
                        <label class="form-label" style="width: 100px;">Year</label>
                        <div class="flex-grow-1">{{ form.year }}</div>
                    </div>
                    <div class="col-md-6 d-flex align-items-center">
                        <label class="form-label" style="width: 100px;">Major</label>
                        <div class="flex-grow-1">{{ form.major }}</div>
                    </div>
                </div>

                <!-- Form row: Password -->
                <div class="row mb-3">
                    <div class="col-md-12 d-flex align-items-center">
                        <label class="form-label" style="width: 100px;">Password</label>
                        <div class="flex-grow-1">{{ form.password }}</div>
                    </div>
                </div>

                <!-- File upload fields with image previews -->
                <div class="row mb-3">
                    <div class="col-md-4 text-center">
                        <label class="form-label">OR Upload</label>
                        {{ form.or_upload }}
                        <div class="preview-container mt-2">
                            <img id="orPreview" class="img-thumbnail preview-img" alt="OR Preview" />
                        </div>
                    </div>
                    <div class="col-md-4 text-center">
                        <label class="form-label">CR Upload</label>
                        {{ form.cr_upload }}
                        <div class="preview-container mt-2">
                            <img id="crPreview" class="img-thumbnail preview-img" alt="CR Preview" />
                        </div>
                    </div>
                    <div class="col-md-4 text-center">
                        <label class="form-label">License Upload</label>
                        {{ form.license_upload }}
                        <div class="preview-container mt-2">
                            <img id="licensePreview" class="img-thumbnail preview-img" alt="License Preview" />
                        </div>
                    </div>
                </div>

                <button type="submit" class="btn btn-primary w-100 mb-3">Register</button>
                <div class="text-center">
                    <p class="text-muted mb-0" style="font-size: 0.9rem;">By registering, you agree to our <a href="#" class="text-primary">Terms & Conditions</a>.</p>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    function previewFiles(inputId, previewId) {
        const input = document.getElementById(inputId);
        const preview = document.getElementById(previewId);

        input.addEventListener('change', function(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    preview.src = e.target.result;
                    preview.classList.remove('d-none');
                };
                reader.readAsDataURL(file);
            }
        });
    }

    previewFiles('id_or_upload', 'orPreview');
    previewFiles('id_cr_upload', 'crPreview');
    previewFiles('id_license_upload', 'licensePreview');
</script>

<style>
    .form-label {
        font-weight: bold;
        margin-bottom: 0.5rem;
    }

    .preview-container {
        width: 100%;
        max-width: 150px;
        height: 150px;
        display: flex;
        align-items: center;
        justify-content: center;
        border: 1px solid #ccc;
        border-radius: 5px;
        overflow: hidden;
        margin-top: 5px;
    }

    .preview-img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .card {
        border: none;
    }

    .overflow-scroll {
        max-height: 500px;
        overflow-y: auto;
    }

    .overflow-scroll::-webkit-scrollbar {
        display: none;
    }
</style>
{% endblock %}
